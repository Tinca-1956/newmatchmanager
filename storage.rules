
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // Allow admins to write to club logos, but anyone can read them
    match /clubs/{clubId}/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null && (get(/databases/(default)/documents/users/$(request.auth.uid)).data.role in ['Site Admin', 'Club Admin']);
    }
    
    // Allow admins to write to match media, but anyone can read them
    match /matches/{matchId}/{allPaths=**} {
      allow read: if true;
       allow write: if request.auth != null && (get(/databases/(default)/documents/users/$(request.auth.uid)).data.role in ['Site Admin', 'Club Admin']);
    }
    
    // Allow Site Admins to write help documents, but anyone can read them
    match /help_documents/{allPaths=**} {
      allow read: if true; // All authenticated users can read help files
      allow write: if request.auth != null && (get(/databases/(default)/documents/users/$(request.auth.uid)).data.role == 'Site Admin');
    }
  }
}
